import"../chunks/Bzak7iHL.js";import{i as zt}from"../chunks/XlqFUZ3x.js";import{p as Jt,f as x,a as vt,s,h as t,r as e,n as At,t as P,u as p,g as r,d as l,b as u,aM as f,e as U,k as C,c as Rt,j as E,o as Vt,aO as Yt,P as Pt,aP as Gt,q as Ct}from"../chunks/nbkepknC.js";import{i as $}from"../chunks/BcVSc5tD.js";import{s as Kt}from"../chunks/2WVzPzKa.js";import{s as Et}from"../chunks/BYJuMw6P.js";import{s as Qt,a as Ut}from"../chunks/D_8yISCJ.js";import{M as Xt}from"../chunks/4cH0hlCX.js";import{e as Ht,i as Bt}from"../chunks/DVrF0WE5.js";import{b as Zt}from"../chunks/DL9iPyes.js";import{p as Ft}from"../chunks/Cs9q_1e7.js";import{n as Ot,M as Wt,f as te,e as ee}from"../chunks/DCbZC6Pe.js";import{p as se}from"../chunks/C3OukU56.js";import{g as jt}from"../chunks/Dk2bme3r.js";var re=x('<div class="mb-4 print:hidden"><div class="block md:hidden mb-4"><!></div> <div class="hidden md:flex space-x-3 action-buttons"><button class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50"> </button> <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">æ‰“å°/ä¿å­˜PDF</button> <button class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">å¯¼å‡ºå¸®åŠ©</button></div></div>'),ae=x('<tr><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td><td class="px-2 py-1 text-center svelte-14vk7sc" style="border: 1px solid #000;"> </td></tr>'),oe=x('<tr><td class="px-2 py-1 text-center svelte-14vk7sc" style="height: 24px; border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td><td class="px-2 py-1 svelte-14vk7sc" style="border: 1px solid #000;"></td></tr>'),ne=x(`<!> <div class="delivery-note print:shadow-none svelte-14vk7sc" style="width: 1280px; min-height: 720px; margin: 0 auto; padding: 40px; box-sizing: border-box; font-family: 'Microsoft YaHei', 'SimSun', serif; background-color: white;"><div class="text-center mb-4 border-b border-gray-400 pb-3"><h1 class="text-xl font-bold mb-1" style="color: #000;"> </h1> <div class="text-xs flex justify-center space-x-8 mb-1" style="color: #333;"><span> </span> <span> </span></div> <h2 class="text-lg font-bold" style="color: #000;">é€ è´§ å•</h2></div> <div class="grid grid-cols-3 gap-4 mb-2 text-xs" style="align-items: center;"><div style="display: flex; align-items: center;"><strong>å®¢æˆ·åç§°ï¼š</strong><span> </span></div> <div style="display: flex; align-items: center;"><strong>å®¢æˆ·ç”µè¯ï¼š</strong><span> </span></div> <div style="display: flex; align-items: center;"><strong>åˆ¶å•äººï¼š</strong><span> </span></div></div> <div class="grid grid-cols-3 gap-4 mb-3 text-xs" style="align-items: center;"><div style="display: flex; align-items: center;"><strong>å®¢æˆ·åœ°å€ï¼š</strong><span> </span></div> <div style="display: flex; align-items: center;"><strong>ç‰©æµåç§°ï¼š</strong><span></span></div> <div style="display: flex; align-items: center;"><strong>é€è´§æ—¥æœŸï¼š</strong><span> </span></div></div> <table class="w-full border-collapse text-xs mb-3 svelte-14vk7sc" style="border: 1px solid #000;"><thead><tr style="background-color: #f5f5f5;"><th class="px-2 py-1 text-center w-12 svelte-14vk7sc" style="border: 1px solid #000;">åºå·</th><th class="px-2 py-1 text-center w-32 svelte-14vk7sc" style="border: 1px solid #000;">äº§å“åç§°</th><th class="px-2 py-1 text-center w-24 svelte-14vk7sc" style="border: 1px solid #000;">è§„æ ¼å‹å·</th><th class="px-2 py-1 text-center w-16 svelte-14vk7sc" style="border: 1px solid #000;">å•ä½</th><th class="px-2 py-1 text-center w-16 svelte-14vk7sc" style="border: 1px solid #000;">æ•°é‡</th><th class="px-2 py-1 text-center w-20 svelte-14vk7sc" style="border: 1px solid #000;">å•ä»·</th><th class="px-2 py-1 text-center w-20 svelte-14vk7sc" style="border: 1px solid #000;">é‡‘é¢</th><th class="px-2 py-1 text-center w-24 svelte-14vk7sc" style="border: 1px solid #000;">å¤‡æ³¨</th></tr></thead><tbody><!><!></tbody></table> <div class="flex justify-between items-center mb-2 text-xs"><div><span class="font-medium">åˆè®¡ï¼ˆå¤§å†™ï¼‰ï¼š</span> <span class="font-bold" style="color: #d32f2f;"> </span></div> <div><span class="font-medium">åˆè®¡ï¼š</span> <span class="text-sm font-bold" style="color: #d32f2f;"> </span></div></div> <div class="flex justify-between items-center mb-2 text-xs"><p style="color: #666;">ä»¥ä¸Šè´§å“è¯·æ ¸å¯¹æ¸…æ¥šï¼Œå¦‚æœ‰è´¨é‡é—®é¢˜è¯·åœ¨3æ—¥å†…è‡´ç”µå‘ŠçŸ¥æœ¬å…¬å¸ï¼Œè°¢è°¢ï¼</p> <span style="color: #666;">ç¬¬1é¡µ/å…±1é¡µ</span></div> <div class="grid grid-cols-2 gap-8 text-xs mt-3"><div><span class="font-medium">é€è´§å•ä½åŠç»æ‰‹äººï¼ˆç­¾ç« ï¼‰ï¼š</span></div> <div><span class="font-medium">æ”¶è´§å•ä½åŠç»æ‰‹äººï¼ˆç­¾ç« ï¼‰ï¼š</span></div></div></div>`,1);function le(wt,X){Jt(X,!1);let a=Ft(X,"invoice",8),kt=Ft(X,"showActions",8,!0),B=U(),i=U(!1);const I=async()=>{if(r(B)){C(i,!0);try{const v=`é€è´§å•-${a().invoiceNumber}-${te(a().date)}`;await ee(r(B),v)}catch(v){console.error("å¯¼å‡ºå¤±è´¥:",v),alert("å¯¼å‡ºå›¾ç‰‡å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{C(i,!1)}}},W=()=>{alert(`ä¿å­˜é€è´§å•ä¸ºå›¾ç‰‡çš„æ–¹æ³•ï¼š

ğŸ–¼ï¸ æ–¹æ³•1ï¼šå³é”®ä¿å­˜
åœ¨é€è´§å•ä¸Šå³é”®ç‚¹å‡»ï¼Œé€‰æ‹©"å¦å­˜ä¸ºå›¾ç‰‡"æˆ–"ä¿å­˜å›¾ç‰‡"

ğŸ“¸ æ–¹æ³•2ï¼šæˆªå›¾å·¥å…·
Windows: Win + Shift + S
Mac: Cmd + Shift + 4

ğŸ–¨ï¸ æ–¹æ³•3ï¼šæ‰“å°ä¸ºPDF
ç‚¹å‡»"æ‰“å°/ä¿å­˜PDF"æŒ‰é’®ï¼Œåœ¨æ‰“å°å¯¹è¯æ¡†ä¸­é€‰æ‹©"ä¿å­˜ä¸ºPDF"

ğŸ“± æ–¹æ³•4ï¼šç§»åŠ¨è®¾å¤‡
é•¿æŒ‰é€è´§å•å›¾ç‰‡ï¼Œé€‰æ‹©"ä¿å­˜å›¾ç‰‡"`)},ct=()=>{window.print()},q=v=>v.toFixed(2),$t=v=>Array(v).fill(null);zt();var Z=ne(),tt=vt(Z);{var It=v=>{var d=re(),N=t(d),J=t(N);Wt(J,{get targetElement(){return r(B)},fileName:"é€è´§å•",showButton:!0}),e(N);var R=s(N,2),n=t(R),c=t(n,!0);e(n);var g=s(n,2),w=s(g,2);e(R),e(d),P(()=>{n.disabled=r(i),l(c,r(i)?"å¯¼å‡ºä¸­...":"ä¿å­˜ä¸ºå›¾ç‰‡")}),E("click",n,I),E("click",g,ct),E("click",w,W),u(v,d)};$(tt,v=>{kt()&&v(It)})}var et=s(tt,2),L=t(et),T=t(L),pt=t(T,!0);e(T);var st=s(T,2),V=t(st),St=t(V);e(V);var ut=s(V,2),Mt=t(ut);e(ut),e(st),At(2),e(L);var o=s(L,2),m=t(o),y=s(t(m)),h=t(y,!0);e(y),e(m);var S=s(m,2),b=s(t(S)),M=t(b,!0);e(b),e(S);var _=s(S,2),D=s(t(_)),F=t(D,!0);e(D),e(_),e(o);var Y=s(o,2),O=t(Y),xt=s(t(O)),rt=t(xt,!0);e(xt),e(O);var mt=s(O,4),G=s(t(mt)),at=t(G,!0);e(G),e(mt),e(Y);var K=s(Y,2),z=s(t(K)),bt=t(z);Ht(bt,1,()=>(f(a()),p(()=>a().items)),Bt,(v,d,N)=>{var J=ae(),R=t(J);R.textContent=N+1;var n=s(R),c=t(n,!0);e(n);var g=s(n),w=t(g,!0);e(g);var H=s(g),Nt=t(H,!0);e(H);var Q=s(H),qt=t(Q,!0);e(Q);var it=s(Q),Dt=t(it,!0);e(it);var k=s(it),j=t(k,!0);e(k);var A=s(k),dt=t(A,!0);e(A),e(J),P((Lt,Tt)=>{l(c,(r(d),p(()=>r(d).productName))),l(w,(r(d),p(()=>r(d).specification))),l(Nt,(r(d),p(()=>r(d).unit))),l(qt,(r(d),p(()=>r(d).quantity))),l(Dt,Lt),l(j,Tt),l(dt,(r(d),p(()=>r(d).note||"")))},[()=>(r(d),p(()=>q(r(d).unitPrice))),()=>(r(d),p(()=>q(r(d).amount)))]),u(v,J)});var ot=s(bt);Ht(ot,1,()=>(f(a()),p(()=>$t(Math.max(0,8-a().items.length)))),Bt,(v,d)=>{var N=oe();u(v,N)}),e(z),e(K);var gt=s(K,2),nt=t(gt),ft=s(t(nt),2),yt=t(ft,!0);e(ft),e(nt);var _t=s(nt,2),lt=s(t(_t),2),ht=t(lt,!0);e(lt),e(_t),e(gt),At(4),e(et),Zt(et,v=>C(B,v),()=>r(B)),P((v,d)=>{l(pt,(f(a()),p(()=>a().companyInfo.name))),l(St,`åœ°å€ï¼š${f(a()),p(()=>a().companyInfo.address)??""}`),l(Mt,`ç”µè¯ï¼š${f(a()),p(()=>a().companyInfo.phone)??""}`),l(h,(f(a()),p(()=>a().customerInfo.name))),l(M,(f(a()),p(()=>a().customerInfo.phone||""))),l(F,(f(a()),p(()=>a().createdBy))),l(rt,(f(a()),p(()=>a().customerInfo.address||""))),l(at,(f(a()),p(()=>a().deliveryDate||a().date))),l(yt,v),l(ht,d)},[()=>(f(Ot),f(a()),p(()=>Ot(a().totalAmount))),()=>(f(a()),p(()=>q(a().totalAmount)))]),u(wt,Z),Rt()}var ie=x('<button class="p-2 rounded-lg hover:bg-black hover:bg-opacity-10 transition-colors" aria-label="ç¼–è¾‘"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button>'),de=x('<div slot="actions"><!> <button class="p-2 rounded-lg hover:bg-black hover:bg-opacity-10 transition-colors" aria-label="æ‰“å°"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path></svg></button></div>'),ve=x('<div class="text-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"></div> <p class="text-gray-500 mt-2">åŠ è½½ä¸­...</p></div>'),ce=x('<div class="bg-red-50 border border-red-200 rounded-lg p-4 text-center"><p class="text-red-600"> </p> <button class="mt-2 bg-red-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors">è¿”å›é”€å”®å•åˆ—è¡¨</button></div>'),pe=x('<div class="text-sm text-gray-600"><span>æœªä»˜é‡‘é¢:</span> <span class="ml-2 text-red-600 font-medium"> </span></div>'),ue=x('<div class="flex justify-between"><span class="text-gray-600">è”ç³»ç”µè¯:</span> <a class="text-blue-600 font-medium"> </a></div>'),xe=x('<div class="flex justify-between"><span class="text-gray-600">åœ°å€:</span> <span class="font-medium text-right max-w-48"> </span></div>'),me=x('<div class="bg-white rounded-lg p-4 shadow-sm border svelte-1wqlfg8"><h3 class="font-medium text-gray-900 mb-3">å®¢æˆ·ä¿¡æ¯</h3> <div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-gray-600">å®¢æˆ·åç§°:</span> <span class="font-medium"> </span></div> <!> <!></div></div>'),be=x('<button class="w-full bg-blue-500 text-white py-3 rounded-lg font-medium hover:bg-blue-600 transition-colors">ç¼–è¾‘é€è´§å•</button>'),ge=x('<button class="w-full bg-red-500 text-white py-3 rounded-lg font-medium hover:bg-red-600 transition-colors">åˆ é™¤é€è´§å•</button>'),fe=x('<div class="bg-white rounded-lg p-4 shadow-sm border svelte-1wqlfg8"><h3 class="font-medium text-gray-900 mb-3">ä¿å­˜é€‰é¡¹</h3> <!></div> <div class="bg-white rounded-lg shadow-sm border overflow-hidden svelte-1wqlfg8"><!></div> <div class="bg-white rounded-lg p-4 shadow-sm border svelte-1wqlfg8"><div class="flex items-center justify-between mb-4"><h3 class="font-medium text-gray-900">å•æ®çŠ¶æ€</h3> <div class="flex space-x-2"><div> </div> <div> </div></div></div> <!></div> <!> <div class="bg-white rounded-lg p-4 shadow-sm border svelte-1wqlfg8"><h3 class="font-medium text-gray-900 mb-3">æ“ä½œ</h3> <div class="space-y-2"><!> <button class="w-full bg-green-500 text-white py-3 rounded-lg font-medium hover:bg-green-600 transition-colors">æ‰“å°é€è´§å•</button> <!></div></div>',1),ye=x('<!> <div class="p-4 space-y-6 mobile-content svelte-1wqlfg8"><!></div>',1);function Ce(wt,X){Jt(X,!1);const a=()=>Ut(se,"$page",kt),[kt,B]=Qt();let i=U(null),I=U(null),W,ct=U(!0),q=U("");Vt(()=>{W=a().params.id||"",$t()});const $t=()=>{try{const o=localStorage.getItem("invoice_history");if(o){const m=JSON.parse(o);if(C(i,m.find(y=>y.id===W)||null),r(i)){const y=localStorage.getItem("customers");if(y){const h=JSON.parse(y);C(I,h.find(S=>{var b;return S.id===((b=r(i))==null?void 0:b.customerId)})||null)}}else C(q,"æœªæ‰¾åˆ°æŒ‡å®šçš„é”€å”®å•")}else C(q,"æ²¡æœ‰æ‰¾åˆ°é”€å”®å•æ•°æ®")}catch(o){console.error("åŠ è½½é”€å”®å•å¤±è´¥:",o),C(q,"åŠ è½½é”€å”®å•å¤±è´¥")}finally{C(ct,!1)}},Z=()=>{jt(`/mobile/sales/${W}/edit`)},tt=()=>{window.print()},It=()=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé”€å”®å•å—ï¼Ÿ"))try{const o=localStorage.getItem("invoice_history");if(o){const y=JSON.parse(o).filter(h=>h.id!==W);localStorage.setItem("invoice_history",JSON.stringify(y)),jt("/mobile/sales")}}catch(o){console.error("åˆ é™¤é”€å”®å•å¤±è´¥:",o),alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•")}},et=o=>`Â¥${o.toFixed(2)}`,L=o=>({draft:{name:"è‰ç¨¿",color:"bg-gray-100 text-gray-800"},confirmed:{name:"å·²ç¡®è®¤",color:"bg-blue-100 text-blue-800"},delivered:{name:"å·²é€è´§",color:"bg-green-100 text-green-800"},cancelled:{name:"å·²å–æ¶ˆ",color:"bg-red-100 text-red-800"}})[o]||{name:"æœªçŸ¥",color:"bg-gray-100 text-gray-800"},T=o=>({unpaid:{name:"æœªä»˜æ¬¾",color:"bg-red-100 text-red-800"},partial:{name:"éƒ¨åˆ†ä»˜æ¬¾",color:"bg-yellow-100 text-yellow-800"},paid:{name:"å·²ä»˜æ¬¾",color:"bg-green-100 text-green-800"}})[o]||{name:"æœªçŸ¥",color:"bg-gray-100 text-gray-800"};zt();var pt=ye();Yt(o=>{Gt.title="é€è´§å•è¯¦æƒ… - ä»è…¾è£…é¥°ææ–™ç®¡ç†ç³»ç»Ÿ"});var st=vt(pt);{let o=Pt(()=>r(i)?`é€è´§å• ${r(i).invoiceNumber}`:"é€è´§å•è¯¦æƒ…");Xt(st,{get title(){return r(o)},showBack:!0,backgroundColor:"bg-green-500",$$slots:{actions:(m,y)=>{var h=de(),S=t(h);{var b=_=>{var D=ie();E("click",D,Z),u(_,D)};$(S,_=>{r(i)&&r(i).status==="draft"&&_(b)})}var M=s(S,2);e(h),E("click",M,tt),u(m,h)}}})}var V=s(st,2),St=t(V);{var ut=o=>{var m=ve();u(o,m)},Mt=o=>{var m=Ct(),y=vt(m);{var h=b=>{var M=ce(),_=t(M),D=t(_,!0);e(_);var F=s(_,2);e(M),P(()=>l(D,r(q))),E("click",F,()=>jt("/mobile/sales")),u(b,M)},S=b=>{var M=Ct(),_=vt(M);{var D=F=>{var Y=fe(),O=vt(Y),xt=s(t(O),2);{let n=Pt(()=>`é€è´§å•-${r(i).invoiceNumber}`);Wt(xt,{targetElement:null,get fileName(){return r(n)},showButton:!0})}e(O);var rt=s(O,2),mt=t(rt);le(mt,{get invoice(){return r(i)},showActions:!1}),e(rt);var G=s(rt,2),at=t(G),K=s(t(at),2),z=t(K),bt=t(z,!0);e(z);var ot=s(z,2),gt=t(ot,!0);e(ot),e(K),e(at);var nt=s(at,2);{var ft=n=>{var c=pe(),g=s(t(c),2),w=t(g,!0);e(g),e(c),P(H=>l(w,H),[()=>et(r(i).totalAmount-r(i).paidAmount)]),u(n,c)};$(nt,n=>{r(i).paymentStatus!=="paid"&&n(ft)})}e(G);var yt=s(G,2);{var _t=n=>{var c=me(),g=s(t(c),2),w=t(g),H=s(t(w),2),Nt=t(H,!0);e(H),e(w);var Q=s(w,2);{var qt=k=>{var j=ue(),A=s(t(j),2),dt=t(A,!0);e(A),e(j),P(()=>{Kt(A,"href",`tel:${r(I).phone??""}`),l(dt,r(I).phone)}),u(k,j)};$(Q,k=>{r(I).phone&&k(qt)})}var it=s(Q,2);{var Dt=k=>{var j=xe(),A=s(t(j),2),dt=t(A,!0);e(A),e(j),P(()=>l(dt,r(I).address)),u(k,j)};$(it,k=>{r(I).address&&k(Dt)})}e(g),e(c),P(()=>l(Nt,r(I).name)),u(n,c)};$(yt,n=>{r(I)&&n(_t)})}var lt=s(yt,2),ht=s(t(lt),2),v=t(ht);{var d=n=>{var c=be();E("click",c,Z),u(n,c)};$(v,n=>{r(i).status==="draft"&&n(d)})}var N=s(v,2),J=s(N,2);{var R=n=>{var c=ge();E("click",c,It),u(n,c)};$(J,n=>{r(i).status==="draft"&&n(R)})}e(ht),e(lt),P((n,c,g,w)=>{Et(z,1,`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${n??""}`,"svelte-1wqlfg8"),l(bt,c),Et(ot,1,`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g??""}`,"svelte-1wqlfg8"),l(gt,w)},[()=>L(r(i).status).color,()=>L(r(i).status).name,()=>T(r(i).paymentStatus).color,()=>T(r(i).paymentStatus).name]),E("click",N,tt),u(F,Y)};$(_,F=>{r(i)&&F(D)},!0)}u(b,M)};$(y,b=>{r(q)?b(h):b(S,!1)},!0)}u(o,m)};$(St,o=>{r(ct)?o(ut):o(Mt,!1)})}e(V),u(wt,pt),Rt(),B()}export{Ce as component};
