import"../chunks/Bzak7iHL.js";import{i as ot}from"../chunks/XlqFUZ3x.js";import{p as it,e as _,g as e,o as nt,f as j,a as lt,t as k,j as f,b as w,c as dt,s,h as t,k as x,m,r as a,n as S,d as h,y as ct}from"../chunks/nbkepknC.js";import{i as N}from"../chunks/BcVSc5tD.js";import{r as J,s as vt}from"../chunks/2WVzPzKa.js";import{s as y}from"../chunks/BYJuMw6P.js";import{b as D}from"../chunks/fLdq3W06.js";import{M as ut}from"../chunks/4cH0hlCX.js";var pt=j('<img alt="avatar" class="w-full h-full object-cover"/>'),mt=ct('<svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>'),gt=j('<p class="text-red-500 text-sm mt-1"> </p>'),ft=j('<p class="text-red-500 text-sm mt-1"> </p>'),bt=j('<div class="fixed inset-0 z-[60] flex items-end md:items-center md:justify-center"><div class="absolute inset-0 bg-black/40" role="button" tabindex="0" aria-label="关闭编辑"></div> <div class="relative w-full md:w-[480px] bg-white rounded-t-2xl md:rounded-xl p-4 md:p-6 max-h-[85vh] overflow-auto"><div class="h-1.5 w-12 bg-gray-300 rounded-full mx-auto md:hidden mb-2"></div> <h3 class="text-base font-medium text-gray-900 mb-4">编辑资料</h3> <div class="space-y-4"><div class="flex items-center space-x-4"><div class="w-16 h-16 rounded-full bg-gray-100 overflow-hidden flex items-center justify-center"><!></div> <label class="text-sm font-medium text-purple-600"><input type="file" accept="image/*" class="hidden"/> 更换头像</label></div> <div><label for="edit-name" class="block text-sm font-medium text-gray-700 mb-1">姓名 <span class="text-red-500">*</span></label> <input id="edit-name" type="text" placeholder="请输入姓名"/> <!></div> <div><label for="edit-company" class="block text-sm font-medium text-gray-700 mb-1">公司</label> <input id="edit-company" type="text" placeholder="请输入公司名称" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"/></div> <div><label for="edit-phone" class="block text-sm font-medium text-gray-700 mb-1">电话</label> <input id="edit-phone" type="tel" placeholder="请输入电话号码"/> <!></div> <div><label for="edit-email" class="block text-sm font-medium text-gray-700 mb-1">邮箱</label> <input id="edit-email" type="email" placeholder="请输入邮箱（可选）" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"/></div></div> <div class="grid grid-cols-2 gap-3 mt-5"><button class="py-2 rounded-lg border border-gray-300 text-gray-700">取消</button> <button class="py-2 rounded-lg bg-purple-500 text-white font-medium hover:bg-purple-600">保存</button></div></div></div>'),xt=j('<!> <div class="p-4 space-y-6"><div class="bg-white rounded-lg p-4 shadow-sm border"><div class="flex items-center space-x-4 mb-4"><div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div> <div class="flex-1"><h3 class="font-medium text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p> <p class="text-sm text-gray-600"> </p></div></div> <button class="w-full bg-purple-500 text-white py-2 rounded-lg font-medium hover:bg-purple-600 transition-colors">编辑资料</button></div> <div class="bg-white rounded-lg p-4 shadow-sm border"><h3 class="font-medium text-gray-900 mb-4">数据统计</h3> <div class="grid grid-cols-2 gap-4"><div class="text-center"><div class="text-lg font-bold text-blue-600"> </div> <div class="text-sm text-gray-500">客户</div></div> <div class="text-center"><div class="text-lg font-bold text-orange-600"> </div> <div class="text-sm text-gray-500">产品</div></div> <div class="text-center"><div class="text-lg font-bold text-green-600"> </div> <div class="text-sm text-gray-500">销售单</div></div> <div class="text-center"><div class="text-lg font-bold text-purple-600"> </div> <div class="text-sm text-gray-500">数据大小</div></div></div></div> <div class="bg-white rounded-lg p-4 shadow-sm border"><h3 class="font-medium text-gray-900 mb-4">应用设置</h3> <div class="space-y-4"><div class="flex items-center justify-between"><div><div class="font-medium text-gray-900">自动保存</div> <div class="text-sm text-gray-500">自动保存表单数据</div></div> <button><span></span></button></div> <div class="flex items-center justify-between"><div><div class="font-medium text-gray-900">消息通知</div> <div class="text-sm text-gray-500">接收应用通知</div></div> <button><span></span></button></div> <div class="flex items-center justify-between"><div><div class="font-medium text-gray-900">深色模式</div> <div class="text-sm text-gray-500">使用深色主题</div></div> <button><span></span></button></div></div></div> <div class="bg-white rounded-lg p-4 shadow-sm border"><h3 class="font-medium text-gray-900 mb-4">数据管理</h3> <div class="space-y-3"><button class="w-full bg-green-500 text-white py-3 rounded-lg font-medium hover:bg-green-600 transition-colors flex items-center justify-center space-x-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span>导出数据</span></button> <button class="w-full bg-red-500 text-white py-3 rounded-lg font-medium hover:bg-red-600 transition-colors flex items-center justify-center space-x-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> <span>清除数据</span></button></div></div> <div class="bg-white rounded-lg p-4 shadow-sm border"><h3 class="font-medium text-gray-900 mb-4">关于应用</h3> <div class="space-y-3 text-sm text-gray-600"><div class="flex justify-between"><span>应用名称</span> <span>Cypridina Client</span></div> <div class="flex justify-between"><span>版本号</span> <span>v1.0.0</span></div> <div class="flex justify-between"><span>构建时间</span> <span>2025-10-14</span></div> <div class="flex justify-between"><span>技术栈</span> <span>SvelteKit + Tauri</span></div></div></div></div> <!>',1);function Mt(Se,ke){it(ke,!1);let v=_({name:"张总",company:"佛山市仁腾装饰材料有限公司",phone:"18575852698",email:"",avatar:""}),l=_({autoSave:!0,notifications:!0,darkMode:!1,language:"zh-CN"}),u=_({customers:0,products:0,invoices:0,dataSize:"0 KB"}),I=_(!1),i=_({...e(v)}),c=_({});const je=()=>{x(i,{...e(v)}),x(c,{}),x(I,!0)},E=()=>{x(I,!1)},Ie=r=>{const n=r.target;if(n.files&&n.files[0]){const d=new FileReader;d.onload=()=>{m(i,e(i).avatar=String(d.result||""))},d.readAsDataURL(n.files[0])}},Me=()=>{x(c,{}),(!e(i).name||!e(i).name.trim())&&m(c,e(c).name="请填写姓名");const r=(e(i).phone||"").replace(/\D/g,"");return e(i).phone&&r.length<6&&m(c,e(c).phone="电话号码格式不正确"),Object.keys(e(c)).length===0},Oe=()=>{Me()&&(x(v,{...e(v),...e(i)}),Ce(),x(I,!1))};nt(()=>{ze(),Be(),te()});const ze=()=>{try{const r=localStorage.getItem("user_info");r&&x(v,{...e(v),...JSON.parse(r)})}catch(r){console.error("加载用户信息失败:",r)}},Be=()=>{try{const r=localStorage.getItem("app_settings");r&&x(l,{...e(l),...JSON.parse(r)})}catch(r){console.error("加载设置失败:",r)}},Ce=()=>{try{localStorage.setItem("user_info",JSON.stringify(e(v)))}catch(r){console.error("保存用户信息失败:",r)}},Ne=()=>{try{localStorage.setItem("app_settings",JSON.stringify(e(l)))}catch(r){console.error("保存设置失败:",r)}},te=()=>{try{const r=JSON.parse(localStorage.getItem("customers")||"[]"),n=JSON.parse(localStorage.getItem("products")||"[]"),d=JSON.parse(localStorage.getItem("invoice_history")||"[]");m(u,e(u).customers=r.length),m(u,e(u).products=n.length),m(u,e(u).invoices=d.length);const b={customers:r,products:n,invoices:d,userInfo:e(v),settings:e(l)},g=new Blob([JSON.stringify(b)]).size;m(u,e(u).dataSize=Je(g))}catch(r){console.error("计算数据统计失败:",r)}},Je=r=>{if(r===0)return"0 B";const n=1024,d=["B","KB","MB","GB"],b=Math.floor(Math.log(r)/Math.log(n));return parseFloat((r/Math.pow(n,b)).toFixed(2))+" "+d[b]},De=()=>{try{const r={customers:JSON.parse(localStorage.getItem("customers")||"[]"),products:JSON.parse(localStorage.getItem("products")||"[]"),invoices:JSON.parse(localStorage.getItem("invoice_history")||"[]"),userInfo:e(v),settings:e(l),exportTime:new Date().toISOString()},n=JSON.stringify(r,null,2),d=new Blob([n],{type:"application/json"}),b=URL.createObjectURL(d),g=document.createElement("a");g.href=b,g.download=`cypridina-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(b),alert("数据导出成功！")}catch(r){console.error("导出数据失败:",r),alert("导出失败，请重试")}},Ee=()=>{confirm("确定要清除所有数据吗？此操作不可恢复！")&&confirm("请再次确认：这将删除所有客户、产品和销售单数据！")&&(localStorage.removeItem("customers"),localStorage.removeItem("products"),localStorage.removeItem("invoice_history"),localStorage.removeItem("customer_categories"),localStorage.removeItem("product_categories"),localStorage.removeItem("product_units"),te(),alert("数据已清除"))},U=r=>{m(l,e(l)[r]=!e(l)[r]),Ne()};ot();var ae=xt(),re=lt(ae);ut(re,{title:"我的",showBack:!0,backgroundColor:"bg-purple-500"});var $=s(re,2),L=t($),R=t(L),se=s(t(R),2),F=t(se),Ue=t(F,!0);a(F);var A=s(F,2),$e=t(A,!0);a(A);var oe=s(A,2),Le=t(oe,!0);a(oe),a(se),a(R);var Re=s(R,2);a(L);var H=s(L,2),ie=s(t(H),2),K=t(ie),ne=t(K),Fe=t(ne,!0);a(ne),S(2),a(K);var T=s(K,2),le=t(T),Ae=t(le,!0);a(le),S(2),a(T);var V=s(T,2),de=t(V),He=t(de,!0);a(de),S(2),a(V);var ce=s(V,2),ve=t(ce),Ke=t(ve,!0);a(ve),S(2),a(ce),a(ie),a(H);var G=s(H,2),ue=s(t(G),2),q=t(ue),M=s(t(q),2),Te=t(M);a(M),a(q);var P=s(q,2),O=s(t(P),2),Ve=t(O);a(O),a(P);var pe=s(P,2),z=s(t(pe),2),Ge=t(z);a(z),a(pe),a(ue),a(G);var me=s(G,2),ge=s(t(me),2),fe=t(ge),qe=s(fe,2);a(ge),a(me),S(2),a($);var Pe=s($,2);{var Qe=r=>{var n=bt(),d=t(n),b=s(d,2),g=s(t(b),4),Q=t(g),W=t(Q),We=t(W);{var Xe=o=>{var p=pt();k(()=>vt(p,"src",e(i).avatar)),w(o,p)},Ye=o=>{var p=mt();w(o,p)};N(We,o=>{e(i).avatar?o(Xe):o(Ye,!1)})}a(W);var be=s(W,2),Ze=t(be);S(),a(be),a(Q);var X=s(Q,2),B=s(t(X),2);J(B);var et=s(B,2);{var tt=o=>{var p=gt(),ee=t(p,!0);a(p),k(()=>h(ee,e(c).name)),w(o,p)};N(et,o=>{e(c).name&&o(tt)})}a(X);var Y=s(X,2),xe=s(t(Y),2);J(xe),a(Y);var Z=s(Y,2),C=s(t(Z),2);J(C);var at=s(C,2);{var rt=o=>{var p=ft(),ee=t(p,!0);a(p),k(()=>h(ee,e(c).phone)),w(o,p)};N(at,o=>{e(c).phone&&o(rt)})}a(Z);var he=s(Z,2),ye=s(t(he),2);J(ye),a(he),a(g);var _e=s(g,2),we=t(_e),st=s(we,2);a(_e),a(b),a(n),k(()=>{y(B,1,`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${e(c).name?"border-red-500":""}`),y(C,1,`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${e(c).phone?"border-red-500":""}`)}),f("click",d,E),f("keydown",d,o=>(o.key==="Escape"||o.key==="Enter")&&(o.preventDefault(),E())),f("change",Ze,Ie),D(B,()=>e(i).name,o=>m(i,e(i).name=o)),D(xe,()=>e(i).company,o=>m(i,e(i).company=o)),D(C,()=>e(i).phone,o=>m(i,e(i).phone=o)),D(ye,()=>e(i).email,o=>m(i,e(i).email=o)),f("click",we,E),f("click",st,Oe),w(r,n)};N(Pe,r=>{e(I)&&r(Qe)})}k(()=>{h(Ue,e(v).name),h($e,e(v).company),h(Le,e(v).phone),h(Fe,e(u).customers),h(Ae,e(u).products),h(He,e(u).invoices),h(Ke,e(u).dataSize),y(M,1,`relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                 ${e(l).autoSave?"bg-purple-500":"bg-gray-200"}`),y(Te,1,`inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                   ${e(l).autoSave?"translate-x-6":"translate-x-1"}`),y(O,1,`relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                 ${e(l).notifications?"bg-purple-500":"bg-gray-200"}`),y(Ve,1,`inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                   ${e(l).notifications?"translate-x-6":"translate-x-1"}`),y(z,1,`relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                 ${e(l).darkMode?"bg-purple-500":"bg-gray-200"}`),y(Ge,1,`inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                   ${e(l).darkMode?"translate-x-6":"translate-x-1"}`)}),f("click",Re,je),f("click",M,()=>U("autoSave")),f("click",O,()=>U("notifications")),f("click",z,()=>U("darkMode")),f("click",fe,De),f("click",qe,Ee),w(Se,ae),dt()}export{Mt as component};
