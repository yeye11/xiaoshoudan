# å‰åç«¯å¯¹æ¥æ–¹æ¡ˆ

## ğŸ“Š å½“å‰çŠ¶æ€

### å‰ç«¯ç°çŠ¶
- âœ… å®Œæ•´çš„ UI ç•Œé¢ï¼ˆSvelteKit + Tailwind CSSï¼‰
- âœ… æœ¬åœ°æ•°æ®å­˜å‚¨ï¼ˆlocalStorageï¼‰
- âœ… å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘
- âŒ **æ²¡æœ‰ API å®¢æˆ·ç«¯**
- âŒ **æ²¡æœ‰åç«¯è¿æ¥**
- âŒ **æ²¡æœ‰è®¤è¯ç³»ç»Ÿ**

### åç«¯ç°çŠ¶
- âœ… å®Œæ•´çš„ API ç«¯ç‚¹ï¼ˆ34+ ä¸ªï¼‰
- âœ… æ•°æ®åº“è®¾è®¡ï¼ˆ10 å¼ è¡¨ï¼‰
- âœ… è®¤è¯ç³»ç»Ÿï¼ˆJWTï¼‰
- âœ… é”™è¯¯å¤„ç†
- âœ… æ—¥å¿—ç³»ç»Ÿ
- âœ… **å·²æˆåŠŸå¯åŠ¨**

---

## ğŸ¯ å¯¹æ¥ç›®æ ‡

1. **åˆ›å»º API å®¢æˆ·ç«¯** - ç»Ÿä¸€çš„ HTTP è¯·æ±‚ç®¡ç†
2. **å®ç°è®¤è¯ç³»ç»Ÿ** - ç™»å½•ã€æ³¨å†Œã€Token ç®¡ç†
3. **æ›¿æ¢æœ¬åœ°å­˜å‚¨** - ä» localStorage æ”¹ä¸ºåç«¯ API
4. **æ•°æ®åŒæ­¥** - å‰ç«¯ä¸åç«¯æ•°æ®ä¿æŒä¸€è‡´
5. **é”™è¯¯å¤„ç†** - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶

---

## ğŸ“‹ å¯¹æ¥æ­¥éª¤

### ç¬¬ 1 æ­¥: åˆ›å»º API å®¢æˆ·ç«¯ (1-2 å°æ—¶)

åˆ›å»º `src/lib/api/client.ts`:
```typescript
// API åŸºç¡€é…ç½®
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3000';

// HTTP å®¢æˆ·ç«¯
export class ApiClient {
  private baseUrl: string;
  private token: string | null = null;

  constructor(baseUrl: string = API_BASE_URL) {
    this.baseUrl = baseUrl;
    this.token = localStorage.getItem('auth_token');
  }

  // è®¾ç½® Token
  setToken(token: string) {
    this.token = token;
    localStorage.setItem('auth_token', token);
  }

  // è·å– Token
  getToken(): string | null {
    return this.token;
  }

  // æ¸…é™¤ Token
  clearToken() {
    this.token = null;
    localStorage.removeItem('auth_token');
  }

  // å‘é€è¯·æ±‚
  private async request(
    method: string,
    endpoint: string,
    data?: any
  ): Promise<any> {
    const url = `${this.baseUrl}${endpoint}`;
    const headers: Record<string, string> = {
      'Content-Type': 'application/json',
    };

    if (this.token) {
      headers['Authorization'] = `Bearer ${this.token}`;
    }

    const response = await fetch(url, {
      method,
      headers,
      body: data ? JSON.stringify(data) : undefined,
    });

    if (!response.ok) {
      throw new Error(`API Error: ${response.statusText}`);
    }

    return response.json();
  }

  // GET è¯·æ±‚
  get(endpoint: string) {
    return this.request('GET', endpoint);
  }

  // POST è¯·æ±‚
  post(endpoint: string, data: any) {
    return this.request('POST', endpoint, data);
  }

  // PUT è¯·æ±‚
  put(endpoint: string, data: any) {
    return this.request('PUT', endpoint, data);
  }

  // DELETE è¯·æ±‚
  delete(endpoint: string) {
    return this.request('DELETE', endpoint);
  }
}

export const apiClient = new ApiClient();
```

### ç¬¬ 2 æ­¥: åˆ›å»ºè®¤è¯æœåŠ¡ (1-2 å°æ—¶)

åˆ›å»º `src/lib/api/auth.ts`:
```typescript
import { apiClient } from './client';

export const authService = {
  // æ³¨å†Œ
  async register(email: string, password: string, name: string, company: string) {
    const response = await apiClient.post('/api/v1/auth/register', {
      email,
      password,
      name,
      company,
    });
    if (response.data?.token) {
      apiClient.setToken(response.data.token);
    }
    return response.data;
  },

  // ç™»å½•
  async login(email: string, password: string) {
    const response = await apiClient.post('/api/v1/auth/login', {
      email,
      password,
    });
    if (response.data?.token) {
      apiClient.setToken(response.data.token);
    }
    return response.data;
  },

  // è·å–å½“å‰ç”¨æˆ·
  async getCurrentUser() {
    return apiClient.get('/api/v1/auth/me');
  },

  // ç™»å‡º
  logout() {
    apiClient.clearToken();
  },
};
```

### ç¬¬ 3 æ­¥: åˆ›å»ºä¸šåŠ¡ API æœåŠ¡ (2-3 å°æ—¶)

åˆ›å»º `src/lib/api/services/`:
- `products.ts` - äº§å“ç®¡ç†
- `customers.ts` - å®¢æˆ·ç®¡ç†
- `sales.ts` - é”€å”®å•ç®¡ç†
- `inventory.ts` - åº“å­˜ç®¡ç†
- `reports.ts` - æŠ¥è¡¨

### ç¬¬ 4 æ­¥: æ›´æ–°å‰ç«¯ Store (2-3 å°æ—¶)

ä¿®æ”¹ `src/lib/stores/dataStore.ts`:
- ä» localStorage æ”¹ä¸º API è°ƒç”¨
- æ·»åŠ åŠ è½½çŠ¶æ€
- æ·»åŠ é”™è¯¯å¤„ç†

### ç¬¬ 5 æ­¥: æ›´æ–°å‰ç«¯é¡µé¢ (3-4 å°æ—¶)

ä¿®æ”¹å„ä¸ªé¡µé¢ç»„ä»¶:
- é”€å”®é¡µé¢
- å®¢æˆ·é¡µé¢
- äº§å“é¡µé¢
- åº“å­˜é¡µé¢

### ç¬¬ 6 æ­¥: æµ‹è¯•å’Œè°ƒè¯• (2-3 å°æ—¶)

- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯æµ‹è¯•

---

## ğŸ“ ç¯å¢ƒé…ç½®

### å‰ç«¯ `.env.local`
```env
VITE_API_URL=http://localhost:3000
```

### åç«¯ `.env`
```env
CORS_ORIGIN=http://localhost:5173,http://localhost:3000,tauri://localhost
```

---

## ğŸ”„ æ•°æ®æµå‘

### å½“å‰æµå‘ï¼ˆæœ¬åœ°ï¼‰
```
ç”¨æˆ·æ“ä½œ â†’ å‰ç«¯ç»„ä»¶ â†’ localStorage â†’ å‰ç«¯ç»„ä»¶ â†’ UI æ›´æ–°
```

### å¯¹æ¥åæµå‘
```
ç”¨æˆ·æ“ä½œ â†’ å‰ç«¯ç»„ä»¶ â†’ API å®¢æˆ·ç«¯ â†’ åç«¯ API â†’ æ•°æ®åº“
                                    â†“
                              åç«¯å“åº” â†’ å‰ç«¯ Store â†’ UI æ›´æ–°
```

---

## âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜

1. **CORS é…ç½®** - åç«¯å·²é…ç½®ï¼Œå‰ç«¯éœ€è¦æ­£ç¡®çš„ API URL
2. **Token ç®¡ç†** - éœ€è¦å¤„ç† Token è¿‡æœŸå’Œåˆ·æ–°
3. **é”™è¯¯å¤„ç†** - éœ€è¦ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
4. **åŠ è½½çŠ¶æ€** - éœ€è¦æ˜¾ç¤ºåŠ è½½ä¸­ã€æˆåŠŸã€å¤±è´¥çŠ¶æ€
5. **ç¦»çº¿æ”¯æŒ** - è€ƒè™‘ç¦»çº¿æ—¶çš„æ•°æ®ç¼“å­˜

---

## ğŸ“Š é¢„è®¡å·¥ä½œé‡

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| API å®¢æˆ·ç«¯ | 1-2h | ğŸ”´ é«˜ |
| è®¤è¯ç³»ç»Ÿ | 1-2h | ğŸ”´ é«˜ |
| ä¸šåŠ¡ API æœåŠ¡ | 2-3h | ğŸ”´ é«˜ |
| æ›´æ–° Store | 2-3h | ğŸ”´ é«˜ |
| æ›´æ–°é¡µé¢ | 3-4h | ğŸŸ¡ ä¸­ |
| æµ‹è¯•è°ƒè¯• | 2-3h | ğŸŸ¡ ä¸­ |
| **æ€»è®¡** | **11-17h** | |

---

## âœ… å¯¹æ¥å®Œæˆæ ‡å¿—

- âœ… ç”¨æˆ·å¯ä»¥æ³¨å†Œå’Œç™»å½•
- âœ… ç”¨æˆ·æ•°æ®ä»åç«¯åŠ è½½
- âœ… é”€å”®å•å¯ä»¥ä¿å­˜åˆ°åç«¯
- âœ… å®¢æˆ·æ•°æ®å¯ä»¥ä»åç«¯åŠ è½½
- âœ… äº§å“æ•°æ®å¯ä»¥ä»åç«¯åŠ è½½
- âœ… åº“å­˜æ•°æ®å¯ä»¥ä»åç«¯åŠ è½½
- âœ… æ‰€æœ‰æ“ä½œéƒ½é€šè¿‡ API è¿›è¡Œ
- âœ… é”™è¯¯å¤„ç†æ­£å¸¸å·¥ä½œ
- âœ… Token ç®¡ç†æ­£å¸¸å·¥ä½œ

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. ç¡®è®¤æ˜¯å¦è¦è¿›è¡Œå‰åç«¯å¯¹æ¥
2. é€‰æ‹©å¯¹æ¥çš„ä¼˜å…ˆçº§ï¼ˆå…¨éƒ¨å¯¹æ¥ vs éƒ¨åˆ†å¯¹æ¥ï¼‰
3. å¼€å§‹å®ç° API å®¢æˆ·ç«¯

