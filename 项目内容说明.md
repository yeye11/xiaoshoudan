# 买卖应用 - 功能总结与使用指南

## 📱 应用概述

这是一个移动端优先的销售管理应用，用于管理销售单、客户、产品等业务数据。应用采用 SvelteKit + TypeScript + Tailwind CSS 开发，数据存储在浏览器的 localStorage 中。

---

## 🏠 主页面 (`/mobile`)

### 功能
- **累计欠款显示**：黄色横幅显示当前累计欠款金额
- **功能模块网格**：8个主要业务模块，分为2列布局

### 业务模块
1. **销售** (红色) - 管理销售单
2. **采购** (橙色) - 管理采购单（开发中）
3. **客户** (蓝色) - 管理客户信息
4. **供应商** (红色) - 管理供应商（开发中）
5. **产品** (橙色) - 管理产品库
6. **库存** (蓝色) - 管理库存（开发中）
7. **费用收入** (红色) - 管理费用和收入（开发中）
8. **退货** (橙色) - 管理退货（开发中）

### 统计数据
- 今日销售额
- 本月销售额
- 客户总数
- 累计欠款

---

## 💼 销售管理 (`/mobile/sales`)

### 销售单列表页面
**路径**: `/mobile/sales`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 销售单列表        [+]         │  <- 返回按钮 + 新建按钮
├─────────────────────────────────┤
│ 搜索框：搜索销售单号、客户名称  │
├─────────────────────────────────┤
│ [↑↓] 按日期排序  [↑↓] 按金额排序 │  <- 排序按钮
├─────────────────────────────────┤
│ ┌─────────────────────────────┐ │
│ │ 单号:INV-001                │ │
│ │ 日期:2025/10/25             │ │
│ │ 金额:¥1,234.50              │ │
│ │              [编辑] [删除]   │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 单号:INV-002                │ │
│ │ 日期:2025/10/24             │ │
│ │ 金额:¥5,678.90              │ │
│ │              [编辑] [删除]   │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

#### 🎯 主要功能

**1. 列表显示**
- 显示所有已创建的销售单
- 每个销售单显示：
  - **单号**：自动生成的销售单编号（如 INV-001）
  - **日期**：销售单创建日期（格式：YYYY/MM/DD）
  - **金额**：销售单总金额（自动计算）
- 列表默认按日期倒序排列（最新的销售单在最前面）

**2. 搜索功能**
- 在顶部搜索框输入关键词
- 支持搜索内容：
  - 销售单号（如 INV-001）
  - 客户名称（如 钟先生）
- 搜索实时过滤列表
- 清空搜索框恢复显示所有销售单

**3. 排序功能**
- 点击"按日期排序"按钮：
  - 第一次点击：按日期升序（最早的在前）
  - 第二次点击：按日期倒序（最新的在前）
  - 显示 ↑ 表示升序，↓ 表示倒序
- 点击"按金额排序"按钮：
  - 第一次点击：按金额升序（最小的在前）
  - 第二次点击：按金额倒序（最大的在前）

**4. 操作按钮**
- **编辑按钮**（蓝色）：
  - 点击进入编辑页面
  - 可修改销售单的所有信息
  - 修改后点击保存返回列表

- **删除按钮**（红色）：
  - 点击弹出确认对话框
  - 确认后删除销售单
  - 删除后无法恢复

- **点击行**：
  - 点击销售单卡片的任何地方（除了按钮）
  - 进入销售单详情页面
  - 可查看完整信息、打印、导出等

**5. 新建销售单**
- 点击右上角 **+** 按钮
- 进入新建销售单页面
- 详见下方"新建销售单页面"

**6. 返回按钮**
- 点击左上角 **←** 按钮
- 返回主页面

#### 🎨 列表项样式
- 白色卡片，圆角边框
- 轻微阴影，悬停时阴影增强
- 列表项之间有间距
- 无焦点指示器黑点

---

### 新建销售单页面
**路径**: `/mobile/sales/new`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 新建销售单        [保存]      │
├─────────────────────────────────┤
│ 基本信息                        │
│ ┌─────────────────────────────┐ │
│ │ 客户: [选择客户 ▼]          │ │
│ │ 日期: [2025/10/25]          │ │
│ │ 单号: INV-001 (自动生成)    │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 产品项目                        │
│ ┌─────────────────────────────┐ │
│ │ 产品名称 / 规格    [删除]   │ │
│ │ 数量: 10  单价: ¥100  小计: ¥1000 │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 另一个产品 / 规格  [删除]   │ │
│ │ 数量: 5   单价: ¥200  小计: ¥1000 │
│ └─────────────────────────────┘ │
│ [+ 选择产品]                    │
├─────────────────────────────────┤
│ 总金额: ¥2,000.00               │
├─────────────────────────────────┤
│ 备注: [输入备注...]             │
├─────────────────────────────────┤
│ [保存销售单]                    │
└─────────────────────────────────┘
```

#### 🎯 详细操作步骤

**第一步：选择客户**
1. 点击"选择客户"下拉框
2. 显示所有已创建的客户列表
3. 可以：
   - 直接点击客户名称选择
   - 在搜索框输入客户名称或电话快速查找
4. 选择后显示客户名称和电话
5. 如果没有需要的客户，可以：
   - 返回主页创建新客户
   - 或在销售单中手动输入客户信息

**第二步：确认销售日期**
- 销售日期默认为今天（自动填充）
- 如需修改：
  1. 点击日期输入框
  2. 选择新的日期
  3. 日期格式：YYYY/MM/DD
- 销售单号自动生成，无需修改

**第三步：添加产品**
1. 点击"+ 选择产品"按钮
2. 进入产品选择页面
3. 在产品列表中选择要添加的产品
4. 为每个产品设置：
   - **数量**：购买数量
   - **单价**：每件的价格
   - **规格**（如果产品有多个规格）：选择具体规格
5. 点击"确认"返回销售单页面
6. 选中的产品自动加载到销售单中

**第四步：管理产品项目**
- **查看产品信息**：
  - 产品名称和规格显示在一行
  - 下方显示：数量、单价、小计金额

- **删除产品**：
  - 点击产品右侧的"删除"按钮
  - 产品从列表中移除
  - 总金额自动重新计算

- **修改产品数量或单价**：
  - 点击产品行进入编辑模式
  - 修改数量或单价
  - 小计金额自动更新

**第五步：查看总金额**
- 总金额自动计算，显示在产品列表下方
- 计算公式：所有产品的（数量 × 单价）之和
- 实时更新，无需手动计算

**第六步：添加备注（可选）**
1. 在"备注"输入框输入内容
2. 可以记录：
   - 特殊要求
   - 送货地址
   - 其他说明
3. 备注会保存到销售单中

**第七步：保存销售单**
1. 检查所有信息是否正确
2. 点击"保存销售单"按钮
3. 销售单保存到 localStorage
4. 自动返回销售单列表
5. 新销售单显示在列表最前面

#### ⚙️ 特殊功能

**1. 自动日期设置**
- 销售日期默认为今天
- 使用本地时间（不受时区影响）
- 格式：YYYY/MM/DD

**2. 自动单号生成**
- 销售单号自动生成（如 INV-001, INV-002）
- 无需手动输入
- 保证唯一性

**3. 自动金额计算**
- 每个产品的小计：数量 × 单价
- 总金额：所有产品小计之和
- 实时更新，无需手动计算

**4. URL参数支持**
- 从客户详情页面创建销售单时，自动选择该客户
- URL 格式：`/mobile/sales/new?customerId=xxx`

**5. 产品预选**
- 从产品选择页面返回时，自动加载选中的产品
- 无需重新选择

---

### 编辑销售单页面
**路径**: `/mobile/sales/[id]/edit`

#### 📋 页面布局
- 与新建销售单页面相同
- 所有字段预填充已保存的数据

#### 🎯 操作步骤

**1. 进入编辑页面**
- 在销售单列表中点击"编辑"按钮
- 或在销售单详情页面点击"编辑"按钮

**2. 修改基本信息**
- 可以修改：
  - 客户（重新选择）
  - 销售日期
- 销售单号不可修改（保持唯一性）

**3. 修改产品项目**
- 添加新产品：点击"+ 选择产品"
- 删除产品：点击产品右侧"删除"按钮
- 修改数量或单价：点击产品行编辑

**4. 修改备注**
- 在备注框修改内容

**5. 保存修改**
- 点击"保存销售单"按钮
- 修改保存到 localStorage
- 自动返回销售单列表

---

### 查看销售单详情页面
**路径**: `/mobile/sales/[id]`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 销售单详情        [编辑] [删除]│
├─────────────────────────────────┤
│ 基本信息                        │
│ 单号: INV-001                   │
│ 日期: 2025/10/25                │
│ 客户: 钟先生                    │
│ 电话: 13800138000               │
├─────────────────────────────────┤
│ 产品明细                        │
│ ┌─────────────────────────────┐ │
│ │ 产品名称 / 规格             │ │
│ │ 数量: 10  单价: ¥100        │ │
│ │ 小计: ¥1,000.00             │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 总金额: ¥2,000.00               │
├─────────────────────────────────┤
│ 备注: [备注内容]                │
├─────────────────────────────────┤
│ [打印] [导出PDF] [导出Excel]    │
└─────────────────────────────────┘
```

#### 🎯 主要功能

**1. 查看完整信息**
- 显示销售单的所有信息：
  - 销售单号
  - 销售日期
  - 客户名称和电话
  - 所有产品明细
  - 总金额
  - 备注

**2. 编辑销售单**
- 点击右上角"编辑"按钮
- 进入编辑页面
- 修改任何信息后保存

**3. 删除销售单**
- 点击右上角"删除"按钮
- 弹出确认对话框
- 确认后删除销售单
- 删除后无法恢复

**4. 打印销售单**
- 点击"打印"按钮
- 打开浏览器打印对话框
- 选择打印机或保存为PDF
- 打印格式优化，适合A4纸张

**5. 导出销售单**
- **导出PDF**：
  - 点击"导出PDF"按钮
  - 下载销售单PDF文件
  - 文件名：销售单号_日期.pdf

- **导出Excel**：
  - 点击"导出Excel"按钮
  - 下载销售单Excel文件
  - 包含所有产品明细
  - 可用Excel打开和编辑

**6. 返回列表**
- 点击左上角"←"按钮
- 返回销售单列表

---

## 👥 客户管理 (`/mobile/customers`)

### 客户列表页面
**路径**: `/mobile/customers`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 客户列表          [+]         │
├─────────────────────────────────┤
│ 搜索框：搜索客户名称、电话...   │
├─────────────────────────────────┤
│ [↑↓] 按名称排序  [↑↓] 按时间排序 │
├─────────────────────────────────┤
│ ┌─────────────────────────────┐ │
│ │ 名称:钟先生                 │ │
│ │ 电话:13800138000            │ │
│ │ 分类:VIP客户                │ │
│ │              [编辑] [删除]   │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 名称:李女士                 │ │
│ │ 电话:13900139000            │ │
│ │ 分类:普通客户               │ │
│ │              [编辑] [删除]   │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

#### 🎯 主要功能

**1. 列表显示**
- 显示所有已创建的客户
- 每个客户显示：
  - **名称**：客户名称
  - **电话**：客户电话号码
  - **分类**：客户分类（如 VIP、普通等）
- 列表默认按创建时间倒序排列（最新创建的客户在最前面）

**2. 搜索功能**
- 在顶部搜索框输入关键词
- 支持搜索内容：
  - 客户名称（如 钟先生）
  - 客户电话（如 13800138000）
  - 客户分类（如 VIP）
- 搜索实时过滤列表
- 清空搜索框恢复显示所有客户

**3. 排序功能**
- 点击"按名称排序"按钮：
  - 第一次点击：按名称升序（A-Z）
  - 第二次点击：按名称倒序（Z-A）

- 点击"按时间排序"按钮：
  - 第一次点击：按创建时间升序（最早的在前）
  - 第二次点击：按创建时间倒序（最新的在前）

**4. 操作按钮**
- **编辑按钮**（蓝色）：
  - 点击进入编辑页面
  - 可修改客户的所有信息
  - 修改后点击保存返回列表

- **删除按钮**（红色）：
  - 点击弹出确认对话框
  - 确认后删除客户
  - 删除后无法恢复
  - 注意：删除客户不会删除相关的销售单

- **点击行**：
  - 点击客户卡片的任何地方（除了按钮）
  - 进入客户详情页面
  - 可查看完整信息、创建销售单等

**5. 新建客户**
- 点击右上角 **+** 按钮
- 进入新建客户页面
- 详见下方"新建客户页面"

**6. 返回按钮**
- 点击左上角 **←** 按钮
- 返回主页面

#### 🎨 列表项样式
- 白色卡片，圆角边框
- 字段格式：`标签:值`（如 `名称:钟先生`）
- 字段之间有间距
- 轻微阴影，悬停时阴影增强
- 无焦点指示器黑点

---

### 新建客户页面
**路径**: `/mobile/customers/new`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 新建客户          [保存]      │
├─────────────────────────────────┤
│ 基本信息                        │
│ ┌─────────────────────────────┐ │
│ │ 客户名称: [输入名称] *      │ │
│ │ 客户地址: [输入地址]        │ │
│ │ 客户电话: [输入电话]        │ │
│ │ 客户邮箱: [输入邮箱]        │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 联系信息                        │
│ ┌─────────────────────────────┐ │
│ │ 联系人名称: [输入名称]      │ │
│ │ 联系人电话: [输入电话]      │ │
│ │ 联系人邮箱: [输入邮箱]      │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 分类和标签                      │
│ ┌─────────────────────────────┐ │
│ │ 客户分类: [选择分类 ▼]      │ │
│ │ 客户标签: [选择标签...]     │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 备注                            │
│ ┌─────────────────────────────┐ │
│ │ [输入备注...]               │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ [保存客户]                      │
└─────────────────────────────────┘
```

#### 🎯 详细操作步骤

**第一步：填写基本信息**

1. **客户名称** （必填，用红色 * 标记）
   - 输入客户的名称
   - 例如：钟先生、李女士、ABC公司
   - 不能为空

2. **客户地址** （可选）
   - 输入客户的地址
   - 例如：北京市朝阳区xxx街道

3. **客户电话** （可选）
   - 输入客户的电话号码
   - 支持格式：
     - 手机：13800138000
     - 座机：010-12345678
   - 在客户列表中可用于搜索

4. **客户邮箱** （可选）
   - 输入客户的邮箱地址
   - 例如：customer@example.com

**第二步：填写联系信息**

1. **联系人名称** （可选）
   - 输入客户公司的联系人名称
   - 例如：王经理

2. **联系人电话** （可选）
   - 输入联系人的电话号码
   - 用于直接联系

3. **联系人邮箱** （可选）
   - 输入联系人的邮箱地址

**第三步：选择分类和标签**

1. **客户分类** （可选）
   - 点击"选择分类"下拉框
   - 选择客户类型：
     - VIP客户
     - 普通客户
     - 潜在客户
     - 其他
   - 可以创建新分类

2. **客户标签** （可选）
   - 点击"选择标签"
   - 可以选择多个标签
   - 例如：长期合作、新客户、高价值等
   - 可以创建新标签

**第四步：添加备注**

1. 在备注框输入内容
2. 可以记录：
   - 客户特殊要求
   - 合作历史
   - 其他说明

**第五步：保存客户**

1. 检查所有必填信息是否完整
2. 点击"保存客户"按钮
3. 客户保存到 localStorage
4. 自动返回客户列表
5. 新客户显示在列表最前面

#### ⚠️ 验证规则

- **客户名称**：必填，不能为空
- **电话格式**：自动验证电话号码格式
- **邮箱格式**：自动验证邮箱格式
- 如有错误，会显示红色错误提示

---

### 编辑客户页面
**路径**: `/mobile/customers/[id]/edit`

#### 📋 页面布局
- 与新建客户页面相同
- 所有字段预填充已保存的数据

#### 🎯 操作步骤

**1. 进入编辑页面**
- 在客户列表中点击"编辑"按钮
- 或在客户详情页面点击"编辑"按钮

**2. 修改客户信息**
- 可以修改所有字段：
  - 基本信息（名称、地址、电话、邮箱）
  - 联系信息（联系人名称、电话、邮箱）
  - 分类和标签
  - 备注

**3. 保存修改**
- 点击"保存客户"按钮
- 修改保存到 localStorage
- 自动返回客户列表

---

### 客户详情页面
**路径**: `/mobile/customers/[id]`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 客户详情          [编辑] [删除]│
├─────────────────────────────────┤
│ 基本信息                        │
│ 名称: 钟先生                    │
│ 地址: 北京市朝阳区xxx街道      │
│ 电话: 13800138000               │
│ 邮箱: customer@example.com      │
├─────────────────────────────────┤
│ 联系信息                        │
│ 联系人: 王经理                  │
│ 联系电话: 13900139000           │
│ 联系邮箱: contact@example.com   │
├─────────────────────────────────┤
│ 分类和标签                      │
│ 分类: VIP客户                   │
│ 标签: 长期合作, 高价值          │
├─────────────────────────────────┤
│ 备注: [备注内容]                │
├─────────────────────────────────┤
│ 销售单历史                      │
│ ┌─────────────────────────────┐ │
│ │ 单号:INV-001  日期:2025/10/25│ │
│ │ 金额:¥1,234.50              │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ [创建销售单] [编辑] [删除]      │
└─────────────────────────────────┘
```

#### 🎯 主要功能

**1. 查看完整信息**
- 显示客户的所有信息：
  - 基本信息（名称、地址、电话、邮箱）
  - 联系信息（联系人、电话、邮箱）
  - 分类和标签
  - 备注

**2. 查看销售单历史**
- 显示与该客户相关的所有销售单
- 每个销售单显示：
  - 销售单号
  - 销售日期
  - 销售金额
- 点击销售单可查看详情

**3. 创建销售单**
- 点击"创建销售单"按钮
- 自动跳转到新建销售单页面
- 自动选择该客户
- 无需重新选择客户

**4. 编辑客户信息**
- 点击右上角"编辑"按钮
- 进入编辑页面
- 修改任何信息后保存

**5. 删除客户**
- 点击右上角"删除"按钮
- 弹出确认对话框
- 确认后删除客户
- 删除后无法恢复
- 注意：删除客户不会删除相关的销售单

**6. 返回列表**
- 点击左上角"←"按钮
- 返回客户列表

---

## 📦 产品管理 (`/mobile/products`)

### 产品列表页面
**路径**: `/mobile/products`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 产品列表          [+]         │
├─────────────────────────────────┤
│ 搜索框：搜索产品名称、分类...   │
├─────────────────────────────────┤
│ [↑↓] 按名称排序  [↑↓] 按分类排序 │
├─────────────────────────────────┤
│ ┌─────────────────────────────┐ │
│ │ 名称:iPhone 15              │ │
│ │ 分类:电子产品               │ │
│ │ 单位:件                     │ │
│ │              [编辑] [删除]   │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 名称:MacBook Pro            │ │
│ │ 分类:电子产品               │ │
│ │ 单位:台                     │ │
│ │              [编辑] [删除]   │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

#### 🎯 主要功能

**1. 列表显示**
- 显示所有已创建的产品
- 每个产品显示：
  - **名称**：产品名称
  - **分类**：产品分类（如 电子产品、服装等）
  - **单位**：产品单位（如 件、台、个等）
- 列表默认按名称升序排列

**2. 搜索功能**
- 在顶部搜索框输入关键词
- 支持搜索内容：
  - 产品名称（如 iPhone）
  - 产品分类（如 电子产品）
  - 产品单位（如 件）
- 搜索实时过滤列表
- 清空搜索框恢复显示所有产品

**3. 排序功能**
- 点击"按名称排序"按钮：
  - 第一次点击：按名称升序（A-Z）
  - 第二次点击：按名称倒序（Z-A）

- 点击"按分类排序"按钮：
  - 第一次点击：按分类升序
  - 第二次点击：按分类倒序

**4. 操作按钮**
- **编辑按钮**（蓝色）：
  - 点击进入编辑页面
  - 可修改产品的所有信息
  - 修改后点击保存返回列表

- **删除按钮**（红色）：
  - 点击弹出确认对话框
  - 确认后删除产品
  - 删除后无法恢复
  - 注意：删除产品不会删除相关的销售单

- **点击行**：
  - 点击产品卡片的任何地方（除了按钮）
  - 进入产品详情页面
  - 可查看完整信息、规格等

**5. 新建产品**
- 点击右上角 **+** 按钮
- 进入新建产品页面
- 详见下方"新建产品页面"

**6. 返回按钮**
- 点击左上角 **←** 按钮
- 返回主页面

#### 🎨 列表项样式
- 白色卡片，圆角边框
- 字段格式：`标签:值`（如 `名称:iPhone 15`）
- 字段之间有间距
- 轻微阴影，悬停时阴影增强
- 无焦点指示器黑点

---

### 新建产品页面
**路径**: `/mobile/products/new`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 新建产品          [保存]      │
├─────────────────────────────────┤
│ 基本信息                        │
│ ┌─────────────────────────────┐ │
│ │ 产品名称: [输入名称] *      │ │
│ │ 产品分类: [选择分类 ▼]      │ │
│ │ 产品单位: [选择单位 ▼]      │ │
│ │ 产品价格: [输入价格]        │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 规格管理                        │
│ ┌─────────────────────────────┐ │
│ │ 规格1: 颜色                 │ │
│ │ 值: 黑色  价格: ¥100  [删除]│ │
│ │ 规格2: 容量                 │ │
│ │ 值: 256GB  价格: ¥200 [删除]│ │
│ │ [+ 添加规格]                │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 标签                            │
│ ┌─────────────────────────────┐ │
│ │ [选择标签...]               │ │
│ │ 已选: 新品, 热销            │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ [切换到批量模式]                │
├─────────────────────────────────┤
│ [保存产品]                      │
└─────────────────────────────────┘
```

#### 🎯 详细操作步骤

**第一步：填写基本信息**

1. **产品名称** （必填，用红色 * 标记）
   - 输入产品的名称
   - 例如：iPhone 15、MacBook Pro
   - 不能为空

2. **产品分类** （可选）
   - 点击"选择分类"下拉框
   - 选择现有分类或创建新分类
   - 例如：电子产品、服装、食品等
   - **特殊功能**：自动记住上次选择的分类
   - 下次新建产品时会自动选择该分类

3. **产品单位** （可选）
   - 点击"选择单位"下拉框
   - 选择现有单位或创建新单位
   - 常见单位：件、台、个、盒、箱等
   - **特殊功能**：自动记住上次选择的单位
   - 下次新建产品时会自动选择该单位

4. **产品价格** （可选）
   - 输入产品的基础价格
   - 例如：9999.99
   - 如果产品有多个规格，可为每个规格设置不同价格

**第二步：添加规格**（可选）

规格用于区分同一产品的不同版本（如颜色、容量等）

1. **添加第一个规格**
   - 点击"+ 添加规格"按钮
   - 输入规格名称（如 颜色、容量）
   - 输入规格值（如 黑色、256GB）
   - 输入该规格的价格（可选）

2. **添加多个规格**
   - 重复上述步骤
   - 可以添加多个规格
   - 例如：
     - 规格1：颜色 - 黑色 - ¥100
     - 规格2：颜色 - 白色 - ¥100
     - 规格3：容量 - 256GB - ¥200
     - 规格4：容量 - 512GB - ¥300

3. **删除规格**
   - 点击规格右侧的"删除"按钮
   - 规格从列表中移除

4. **规格的作用**
   - 在销售单中选择产品时，可以选择具体的规格
   - 不同规格可以有不同的价格
   - 便于管理产品的多个版本

**第三步：添加标签**（可选）

1. **选择标签**
   - 点击"选择标签"
   - 可以选择多个标签
   - 例如：新品、热销、限时优惠等

2. **创建新标签**
   - 如果没有需要的标签，可以创建新标签
   - 输入标签名称后添加

3. **移除标签**
   - 点击已选标签旁的 × 按钮
   - 标签从列表中移除

4. **特殊功能**：自动记住上次选择的标签
   - 下次新建产品时会自动选择该标签

**第四步：保存产品**

1. 检查所有必填信息是否完整
2. 点击"保存产品"按钮
3. 产品保存到 localStorage
4. 自动返回产品列表
5. 新产品显示在列表中

#### 🎯 批量创建模式

**启用批量模式**
1. 点击"切换到批量模式"按钮
2. 页面切换到批量创建界面

**批量创建步骤**
1. 输入多个产品名称
2. 支持分隔符：
   - 逗号：iPhone 15, iPhone 14, iPhone 13
   - 分号：iPhone 15; iPhone 14; iPhone 13
   - 换行：
     ```
     iPhone 15
     iPhone 14
     iPhone 13
     ```
3. 所有产品会使用相同的：
   - 分类
   - 单位
   - 标签
   - 价格
4. 点击"保存产品"
5. 一次创建多个产品

**批量创建的优势**
- 快速创建多个相似产品
- 无需逐个输入
- 节省时间

#### ⭐ 特殊功能：记住上次选择

**功能说明**
- 应用会自动记住上次创建产品时选择的：
  - 产品分类
  - 产品单位
  - 产品标签

**工作原理**
1. 第一次创建产品：
   - 选择分类、单位、标签
   - 保存产品
   - 应用记住这些选择

2. 第二次创建产品：
   - 打开新建产品页面
   - 分类、单位、标签自动填充为上次的选择
   - 可以直接修改或保持不变

3. 存储位置
   - 数据存储在浏览器 localStorage 中
   - 键名：
     - `last_product_category` - 上次分类
     - `last_product_unit` - 上次单位
     - `last_product_tags` - 上次标签

**优势**
- 提高创建效率
- 减少重复操作
- 适合批量创建相似产品

#### ⚠️ 验证规则

- **产品名称**：必填，不能为空
- **价格格式**：必须是数字，支持小数点
- 如有错误，会显示红色错误提示

---

### 产品选择页面
**路径**: `/mobile/products/select`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 选择产品          [确认]      │
├─────────────────────────────────┤
│ 搜索框：搜索产品...             │
├─────────────────────────────────┤
│ ┌─────────────────────────────┐ │
│ │ ☐ iPhone 15                 │ │
│ │   分类: 电子产品            │ │
│ │   数量: [1]  单价: [9999]   │ │
│ │   规格: [选择规格 ▼]        │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ ☐ MacBook Pro               │ │
│ │   分类: 电子产品            │ │
│ │   数量: [1]  单价: [12999]  │ │
│ │   规格: [选择规格 ▼]        │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 已选: 2 个产品                  │
├─────────────────────────────────┤
│ [确认选择]                      │
└─────────────────────────────────┘
```

#### 🎯 操作步骤

**1. 搜索产品**
- 在搜索框输入产品名称
- 实时过滤产品列表
- 清空搜索框显示所有产品

**2. 选择产品**
- 点击产品左侧的复选框 ☐
- 复选框变为 ☑（已选中）
- 可以选择多个产品

**3. 设置产品数量**
- 在"数量"输入框输入购买数量
- 默认为 1
- 支持任意正整数

**4. 设置产品单价**
- 在"单价"输入框输入价格
- 默认为产品的基础价格
- 可以修改为不同的价格

**5. 选择产品规格**（如果产品有规格）
- 点击"选择规格"下拉框
- 选择具体的规格
- 例如：颜色、容量等
- 不同规格可能有不同的价格

**6. 查看已选产品**
- 页面下方显示"已选: X 个产品"
- 显示已选产品的总数

**7. 确认选择**
- 检查所有选择是否正确
- 点击"确认选择"按钮
- 返回销售单新建页面
- 选中的产品自动加载到销售单中

#### 💡 使用场景

- 从销售单新建页面点击"+ 选择产品"时跳转到此页面
- 可以一次选择多个产品
- 为每个产品设置不同的数量和价格
- 返回销售单页面后，所有产品自动加载

---

### 编辑产品页面
**路径**: `/mobile/products/[id]/edit`

#### 📋 页面布局
- 与新建产品页面相同
- 所有字段预填充已保存的数据

#### 🎯 操作步骤

**1. 进入编辑页面**
- 在产品列表中点击"编辑"按钮
- 或在产品详情页面点击"编辑"按钮

**2. 修改产品信息**
- 可以修改所有字段：
  - 产品名称
  - 产品分类
  - 产品单位
  - 产品价格

**3. 修改规格**
- 添加新规格：点击"+ 添加规格"
- 删除规格：点击规格右侧"删除"按钮
- 修改规格信息：直接编辑输入框

**4. 修改标签**
- 添加新标签：点击"选择标签"
- 移除标签：点击标签旁的 × 按钮

**5. 保存修改**
- 点击"保存产品"按钮
- 修改保存到 localStorage
- 自动返回产品列表

---

### 产品详情页面
**路径**: `/mobile/products/[id]`

#### 📋 页面布局
```
┌─────────────────────────────────┐
│ ← 产品详情          [编辑] [删除]│
├─────────────────────────────────┤
│ 基本信息                        │
│ 名称: iPhone 15                 │
│ 分类: 电子产品                  │
│ 单位: 件                        │
│ 价格: ¥9,999.99                 │
├─────────────────────────────────┤
│ 规格                            │
│ ┌─────────────────────────────┐ │
│ │ 颜色: 黑色 (¥100)           │ │
│ │ 颜色: 白色 (¥100)           │ │
│ │ 容量: 256GB (¥200)          │ │
│ │ 容量: 512GB (¥300)          │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 标签                            │
│ 新品, 热销, 限时优惠            │
├─────────────────────────────────┤
│ [编辑] [删除]                   │
└─────────────────────────────────┘
```

#### 🎯 主要功能

**1. 查看完整信息**
- 显示产品的所有信息：
  - 产品名称
  - 产品分类
  - 产品单位
  - 产品价格

**2. 查看规格**
- 显示所有产品规格
- 每个规格显示：
  - 规格名称
  - 规格值
  - 规格价格（如果有）

**3. 查看标签**
- 显示所有产品标签

**4. 编辑产品**
- 点击右上角"编辑"按钮
- 进入编辑页面
- 修改任何信息后保存

**5. 删除产品**
- 点击右上角"删除"按钮
- 弹出确认对话框
- 确认后删除产品
- 删除后无法恢复

**6. 返回列表**
- 点击左上角"←"按钮
- 返回产品列表

---

## 🎨 UI 组件和样式

### 列表项样式
- **容器**：白色卡片，圆角（rounded-lg）
- **边框**：灰色边框（border-gray-200）
- **阴影**：轻微阴影（shadow-sm），悬停时增强（shadow-md）
- **间距**：列表项之间使用 `gap-3`（不是 margin）
- **焦点指示器**：完全移除（无黑点）

### 表单字段
- **输入框**：灰色边框，圆角
- **焦点状态**：移除 ring 效果，保持简洁
- **错误提示**：红色边框和错误文本

### 按钮
- **主按钮**：紫色（销售）、蓝色（客户）、橙色（产品）
- **编辑按钮**：蓝色文字
- **删除按钮**：红色文字
- **悬停效果**：背景色变化

---

## � 常见操作快速指南

### 快速创建销售单
1. 主页 → 销售 → + 按钮
2. 选择客户
3. 点击"+ 选择产品"
4. 选择产品并设置数量、单价
5. 返回销售单页面
6. 点击"保存销售单"

### 快速创建客户
1. 主页 → 客户 → + 按钮
2. 输入客户名称（必填）
3. 输入电话、地址等信息
4. 选择分类和标签
5. 点击"保存客户"

### 快速创建产品
1. 主页 → 产品 → + 按钮
2. 输入产品名称（必填）
3. 选择分类、单位（自动记住）
4. 添加规格和标签（可选）
5. 点击"保存产品"

### 快速搜索
- 在任何列表页面的搜索框输入关键词
- 实时过滤结果
- 支持模糊搜索

### 快速排序
- 点击排序按钮切换升序/倒序
- 按钮显示 ↑ 表示升序，↓ 表示倒序

### 快速编辑
- 在列表中点击"编辑"按钮
- 修改信息后点击"保存"

### 快速删除
- 在列表中点击"删除"按钮
- 确认删除
- 注意：删除后无法恢复

---

## 💡 使用技巧

### 1. 充分利用"记住选择"功能
- 产品分类、单位、标签会自动记住
- 适合批量创建相似产品
- 大大提高创建效率

### 2. 使用批量创建模式
- 创建多个相似产品时使用
- 支持多种分隔符（逗号、分号、换行）
- 一次创建多个产品

### 3. 充分利用规格功能
- 为产品的不同版本设置规格
- 不同规格可以有不同的价格
- 在销售单中可以选择具体规格

### 4. 使用标签分类产品
- 为产品添加标签便于管理
- 可以快速搜索和过滤
- 支持多个标签

### 5. 从客户详情页面创建销售单
- 点击"创建销售单"按钮
- 自动选择该客户
- 无需重新选择

### 6. 使用搜索功能快速查找
- 支持模糊搜索
- 实时过滤结果
- 比手动滚动快得多

### 7. 定期检查销售单历史
- 在客户详情页面查看销售单历史
- 了解客户的购买记录
- 便于后续跟进

---

## ⚙️ 数据管理

### 数据存储位置
- 所有数据存储在浏览器的 **localStorage** 中
- 数据格式：JSON
- 数据持久化：关闭浏览器后数据仍然保存

### 数据备份建议
- 定期导出销售单为 PDF 或 Excel
- 便于数据备份和分析
- 防止数据丢失

### 数据清除
- 清除浏览器缓存会删除所有数据
- 建议在清除缓存前导出重要数据
- 无法恢复已删除的数据

### localStorage 键名参考
```
invoice_history          - 销售单列表
customers               - 客户列表
products                - 产品列表
global_tags             - 全局标签
global_specifications   - 全局规格
last_product_category   - 上次选择的产品分类
last_product_unit       - 上次选择的产品单位
last_product_tags       - 上次选择的产品标签
```

---

## 🚀 最近更新

### 最新功能
- ✅ 销售单和客户列表默认按时间倒序排序
- ✅ 销售日期默认选择今天（修复UTC时区问题）
- ✅ 产品新建页面记住上次选择的分类、单位、标签
- ✅ 所有列表页面都有返回按钮（除了主页）
- ✅ 列表项样式优化（白色卡片、圆角、阴影）
- ✅ 移除列表项焦点指示器黑点
- ✅ 产品名称和规格垂直居中对齐

---

## 📝 注意事项

### 重要提醒
1. **数据持久化**
   - 所有数据存储在浏览器 localStorage 中
   - 清除浏览器数据会丢失所有信息
   - 建议定期导出重要数据

2. **时区问题**
   - 销售日期使用本地时间
   - 不受时区影响
   - 确保系统时间正确

3. **批量创建**
   - 产品支持批量创建
   - 可用逗号、分号或换行分隔
   - 所有产品使用相同的分类、单位、标签

4. **自动计算**
   - 销售单的总金额会自动计算
   - 无需手动输入
   - 修改数量或单价时自动更新

5. **记住选择**
   - 产品分类、单位、标签会自动记住
   - 下次创建产品时自动填充
   - 可以手动修改

6. **删除操作**
   - 删除后无法恢复
   - 删除客户不会删除相关销售单
   - 删除产品不会删除相关销售单
   - 建议谨慎操作

7. **搜索功能**
   - 支持模糊搜索
   - 实时过滤结果
   - 不区分大小写

8. **排序功能**
   - 点击排序按钮切换升序/倒序
   - 按钮显示 ↑ 表示升序，↓ 表示倒序
   - 默认排序因模块而异

---

## 🎯 使用场景示例

### 场景1：创建一个完整的销售单
```
1. 打开应用，进入主页
2. 点击"销售"模块
3. 点击右上角 + 按钮
4. 选择客户"钟先生"
5. 销售日期自动为今天
6. 点击"+ 选择产品"
7. 选择"iPhone 15"，数量10，单价9999
8. 选择"MacBook Pro"，数量2，单价12999
9. 返回销售单页面，产品自动加载
10. 总金额自动计算为 ¥125,978
11. 添加备注"送货地址：xxx"
12. 点击"保存销售单"
13. 返回销售单列表，新销售单显示在最前面
```

### 场景2：批量创建产品
```
1. 打开应用，进入主页
2. 点击"产品"模块
3. 点击右上角 + 按钮
4. 点击"切换到批量模式"
5. 输入产品名称：
   iPhone 15
   iPhone 14
   iPhone 13
6. 选择分类"电子产品"
7. 选择单位"件"
8. 点击"保存产品"
9. 一次创建3个产品
```

### 场景3：查看客户销售历史
```
1. 打开应用，进入主页
2. 点击"客户"模块
3. 点击客户"钟先生"
4. 进入客户详情页面
5. 查看"销售单历史"部分
6. 显示与该客户相关的所有销售单
7. 点击销售单可查看详情
```

---

## 📞 常见问题

### Q: 销售日期为什么显示错误的日期？
A: 这是时区问题。应用已修复为使用本地时间，确保系统时间正确即可。

### Q: 如何恢复已删除的数据？
A: 删除后无法恢复。建议定期导出重要数据作为备份。

### Q: 产品分类、单位、标签会自动记住吗？
A: 是的。产品分类、单位、标签会自动记住，下次创建产品时会自动填充。

### Q: 如何批量创建产品？
A: 在新建产品页面点击"切换到批量模式"，输入多个产品名称（用逗号、分号或换行分隔），然后保存。

### Q: 删除客户会删除相关的销售单吗？
A: 不会。删除客户只删除客户信息，相关的销售单仍然保存。

### Q: 如何导出销售单？
A: 在销售单详情页面点击"导出PDF"或"导出Excel"按钮。

### Q: 搜索功能支持哪些内容？
A: 支持模糊搜索，可以搜索名称、电话、分类等信息。

### Q: 如何修改已创建的销售单？
A: 在销售单列表中点击"编辑"按钮，修改信息后点击"保存"。

---

## �💾 数据存储

### localStorage 键名
- `invoice_history` - 销售单列表
- `customers` - 客户列表
- `products` - 产品列表
- `global_tags` - 全局标签
- `global_specifications` - 全局规格
- `last_product_category` - 上次选择的产品分类
- `last_product_unit` - 上次选择的产品单位
- `last_product_tags` - 上次选择的产品标签

### 数据结构
所有数据都以 JSON 格式存储在 localStorage 中，包含：
- 唯一ID（UUID）
- 创建时间（createdAt）
- 更新时间（updatedAt）
- 其他业务字段

---

## 🔄 工作流程示例

### 创建销售单的完整流程
1. 点击主页的"销售"模块
2. 点击右上角 + 按钮
3. 选择客户（或手动输入客户信息）
4. 点击"+ 选择产品"
5. 在产品选择页面选择产品并设置数量、单价
6. 返回销售单页面，产品自动加载
7. 修改销售日期（默认今天）
8. 添加备注（可选）
9. 点击"保存"按钮
10. 返回销售单列表，新销售单显示在最前面（按日期倒序）

### 创建产品的完整流程
1. 点击主页的"产品"模块
2. 点击右上角 + 按钮
3. 输入产品名称
4. 选择分类（自动记住上次选择）
5. 选择单位（自动记住上次选择）
6. 添加规格（可选）
7. 添加标签（自动记住上次选择）
8. 点击"保存"按钮
9. 返回产品列表



